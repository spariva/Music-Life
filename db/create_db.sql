DROP TABLE IF EXISTS COMENTARIOS;
DROP TABLE IF EXISTS RATING;
DROP TABLE IF EXISTS TOKENS;
DROP TABLE IF EXISTS PLAYLIST;
DROP TABLE IF EXISTS USER;

CREATE TABLE USER(
    NAME VARCHAR(26) NOT NULL UNIQUE,
    EMAIL VARCHAR(50) NOT NULL UNIQUE,
    PASSWORD VARCHAR(60) NOT NULL
);

CREATE TABLE PLAYLIST(
  LINK VARCHAR(90) NOT NULL UNIQUE,
  USER_NAME VARCHAR(26) NOT NULL,
  FOREIGN KEY (USER_NAME) REFERENCES USER(NAME) ON DELETE CASCADE 
);

CREATE TABLE TOKENS (
    ID INT(11) UNSIGNED AUTO_INCREMENT NOT NULL,
    TOKEN CHAR(60),
    USERID VARCHAR(50) NOT NULL,
    EXPIRES DATE, 
    TIPO ENUM('ACTIVATE', 'REMEMBER', 'RECOVERY') NOT NULL, -- REMEMBER es el recuerdame ACTIVATE es activar user y recovery para recuperar psswd
    PRIMARY KEY (ID)
);

CREATE TABLE COMENTARIOS(
    COMENTARIO_ID INT(6) PRIMARY KEY AUTO_INCREMENT,
    COMENTARIO VARCHAR(200) NOT NULL,
    AUTOR VARCHAR(26) NOT NULL,
    LINK VARCHAR(90) NOT NULL,
    FOREIGN KEY (AUTOR) REFERENCES USER(NAME) ON DELETE CASCADE,
    FOREIGN KEY (LINK) REFERENCES PLAYLIST(LINK) ON DELETE CASCADE
);
